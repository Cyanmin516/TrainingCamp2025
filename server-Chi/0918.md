# Linux Network Setting
- speacher: pro.Chi
- date: 2025-9-18
- class 8

#VMware_bridge #wordpress #container 

## trouble 
VM 橋接跑掉，手動設定網卡VMnet10-bridge-NIC
2: ens160: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state **DOWN** group default qlen 1000

### VM BUG
VMnet19 do not rename the bridge NIC. 
set bridge and IP/mask/gateway, while ping, change to the custom NIC VMnet19. 

## 站台 log
網卡錯誤
沒有紀錄
```sh
cat /etc/nginx/nginx.conf
cat /etc/nginx/conf.d/php-fpm.conf
cat /etc/nginx/default.d/php.conf
vim /etc/nginx/conf.d/wp.conf
###
server {
    listen 80;
    server_name www.student103.example.com;
    root /usr/share/nginx/html/wordpress;

    error_log /var/log/nginx/wp_error.log;
    include /etc/nginx/default.d/*.conf;
}
###

vim /etc/nginx/conf.d/dbadmin.conf
###
server {
    listen 80;
    server_name dbadmin.student103.example.com;
    root /usr/share/nginx/html/phpMyAdmin;

    error_log /var/log/nginx/db_error.log;
    include /etc/nginx/default.d/*.conf;
}
###

重啟設定
nginx -t
nginx -s reload


vim /var/named/studnet.zone
#last line, add new hosts
dbadmin IN A <myIP>

重啟DNS
systemctl restart named
```
 



## container
```sh
安裝工具
dnf install container-tools
找容器, 公開pod風險高, 可以找redhat官方
podman search nginx
podman search php
podman search wordpress
安裝redhat nginx
認證需求登入redhat.io
...
podman image
podman inspect <imag>
podman run -d --name <website1> -p 8080:8080 <image>
識別碼
podman rm website1
podman run -d --name <website1> -p 8080:8080 -p 8443:8443 <image>
podman ps
podman ps -a
firewall-cmd --add-port=8080
firewall-cmd --add-port=8443

podman exec -it website1 bash


檔案在哪
/var/lib/containers/storages/overlay-images

刪除
podman images
podman rmi <ID>
```


登入redhat
```sh
redgistor.redhat
```
### 內部啟動pod
podman exec -it website2 bash

ss -nlp | grep 8080
cd /opt/bitnami/scripts




## why VM and docker
* **虛擬機 (VM)** 提高了**硬體利用率**，而不是硬體可用性。它的核心概念是在一台實體伺服器上，模擬多台獨立的虛擬伺服器，讓你的硬體資源（CPU、記憶體、儲存空間）可以更充分地分配給不同的作業系統和應用程式，避免資源閒置。這提供了極高的**隔離性**和**安全性**。

* **容器 (Container)** 則提供了**可攜性**和**環境一致性**。它打包了應用程式及其所有依賴項，讓這個「包裝好的應用程式」可以在任何支援容器的環境中運行，確保無論在哪裡部署，行為都完全一致。這大大簡化了開發和部署的流程。

簡單來說，VM 解決的是「**如何讓一台機器跑多個作業系統**」的問題，而容器解決的是「**如何讓一個應用程式在任何地方都能穩定運行**」的問題。

在實際應用中，它們常常是互相搭配使用的：在 VM 提供的安全、隔離環境中，運行多個容器來提高效率和部署彈性。

## choose VM or docker
在實務上，判斷單一容器的資源佔用率是否高到應該直接使用虛擬機（VM），並沒有一個絕對的百分比數字，但通常會依據以下幾個考量點來決定：

* **80% 以上的 CPU 或 RAM 佔用率**：如果你的單一容器長期且穩定地佔用 VM 總資源的 **80% 以上**，這是一個強烈的訊號。這意味著你的應用程式已經成為這個 VM 上的**主要甚至唯一的工作負載**。在這種情況下，將這個應用程式直接部署到一個專屬的虛擬機上，可能比容器化更有優勢，因為你不再需要容器的輕量與彈性來與其他服務共享資源。

---



### **為什麼在這種情況下，虛擬化可能更好？**

* **資源隔離與效能穩定性**：當單一容器佔用絕大多數資源時，容器的**共用核心**優勢就不那麼明顯了。相反，虛擬機的**獨立核心**特性可以提供更強的資源隔離與效能保證。這可以確保你的應用程式效能不會受到主機上其他潛在進程或微小服務的影響，提供最高的穩定性。
* **安全性考量**：如果你的應用程式需要處理高度敏感的資料或執行關鍵任務，將其部署在一個獨立的虛擬機上，能獲得**最高層級的隔離**。即使容器技術已經非常安全，但虛擬機提供的硬體層級隔離仍然是最高標準，因為每個 VM 都有自己的作業系統核心。
* **授權與相容性**：有些舊式軟體或第三方應用程式可能不支援在容器環境中運行，或者其授權條款要求在一個獨立的作業系統實例中運行。在這種情況下，使用虛擬機是唯一的選擇。
* **管理便利性**：當一個容器的資源佔用率已經接近專屬 VM 時，使用虛擬化管理工具（如 VMware vSphere 或 Proxmox VE）來管理這個 VM，可能比使用 Docker 或 Kubernetes 來管理單一容器更簡單直接。

總結來說，如果你的應用程式已經大到**不需要與其他應用程式共享主機**，並且對**穩定性、安全性有極高要求**，那麼即使只是一個容器，當其資源佔用超過 VM 的 **80%** 時，直接為其分配一個專屬的虛擬機，會是一個更合理、更穩健的選擇。