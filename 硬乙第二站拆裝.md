# 硬乙裝修第二站
1. 電腦拆裝即故障排除
2. 電腦服務安裝

伺服器: windows 2020
Client: win10(22)
vm: ubuntu


## Server
1. OS: windwos server 2019
2. services: DNS, DHCP, ROUTER, IIS(WEB and FTP).
3. ip nics
- private IP
- 192.168.140.100/24
- 172.16.140.100/24
4. 用跳接線連接client
- 製作網路接頭 568A - 568B
5. members
- master(administrators)
- user1
- user2
6. NTFS
管理資料夾權限給使用者
- public
- user1_folder
- user2_folder
7. 共享
將資料夾設定可以遠端存取，編輯**共用權限**
8. firewall
close or wf.msc
open ipv4


## client
1. OS: windows10 ver21
- admin= `master`
2. 設定IP, mask, gateway: 
- IP=172.16.140.101/24
- gateway=172.16.140.100
- dns=172.16.140.100
3. 建立使用者
- user1, user2
4. firewall
close or wf.msc
open ipv4
5. 新建虛擬機
- 虛擬化軟體 vmware
vm setting
```
ISO = ubuntu.iso
network = bridge
IP = DHCP
gateway = 192.168.140.100
DNS = 192.168.140.100

test
ping 172.16.140.101

predict
[server] 192.168.140.100
reach 172.168.140.101
```
 
 

## trouble shoot
1. UEFI 電壓不足
- Q: 3.3V電壓不足
- 方法: 拔SSD電源, 減少轉接線, 減少裝置數量
- A: 電源24-pin轉接線耗損，直連不要轉接線

2. 系統安裝 磁碟無法安裝
- Q: 此磁碟為MBR(簡易磁碟區) 若要安裝Windows要選擇GPT格式
- A: 刪除磁碟區，重新設定

3. DNS, DHCP
- Q: DNS無法搜尋IP, 包含自己的IP(192.168.140.100)
- A: 網路線不良，重新插拔，確認網路孔燈號運作正常
- A: 介面卡對應網路孔，本次練習上方的網孔為2，下方為1
- A: **沒有連線的網路孔可能導致無法服務**
- A: IP衝突

4. 印表機沒驅動
- Q:  用列印管理 新增的印表機驅動沒跟上
- A: 印表機上限4台，先刪除錯誤設備，使用控制台>硬體>新增印表機>沒有列出>手動新增>印表機連接埠>製造&版本> 名稱:A> 預設(B不用)


5. ftp and 列印機
- Q: 無法連線，存取被拒
- A: client端使用者名稱與權限(G:administrator)要符合
- A: Client端建立使用者user1、user2

6. VM IP
- Q:拿到DHCP的IP但是無法ping到另一個網域
- A:伺服器主機IP設定錯誤

7. VM 實體橋接設定
- vmware bridge setting, edit > virtrual network editor > change setting (admin) > add 'VMnet19' > bridege > NIC 'Reltek XXXX'
- custom segment 選擇 VMnet19

8. 螢幕，顯示卡不支援UEFI模式，強制啟動CSM
- UEFI, F7, advance, CPU 
- 資料分割選擇MBR，包含傳統的BIOS

9. 路由 traceroute, 查看路由
- 只能在client host 下用 tracert IP, 虛擬機中無法正確路由
10. 路由 可以ping server但是無法路由
- 檢查伺服器路由服務啟動狀態. 
- 啟動路由
- 啟動路由
- 啟動路由服務主機

11. 路由 ubuntu tracepath問題
- 做兩次 tracepath 192.168.140.110 ; tracepath -b 192.168.140.110
12. client within windows 2019 will not dectect the printer correctly.
- reinstall the OS windows 10  2022 version or later



**DHCP**
```
確認並修正 DHCP 伺服器設定
在 Windows Server 2019 上，開啟伺服器管理員，進入 工具，選擇 DHCP。
在 DHCP 管理介面中，展開您的伺服器，然後展開 IPv4。
展開範圍 (Scope)，然後點擊範圍選項 (Scope Options)。
檢查右側窗格中的選項：
    003 路由器 (Router)：這個值必須設定為您的路由器或防火牆的 IP 位址，而不是伺服器的 IP。
    006 DNS 伺服器 (DNS Servers)：這個值必須設定為正確的 DNS 伺服器 IP 位址。如果您的網路使用公共 DNS (例如 Google 的 8.8.8.8 或 Cloudflare 的 1.1.1.1)，請將其新增進去。
```

**Ubuntu**
``` 
看DHCP資訊
IP/mask, 檢測實體連線
route, 很重要一定要拿到
DNS
```
- IP/mask沒取得，VMware => edit => network manager => Change => add bridge / NIC check => apply
- VM setting network VMnet0

- route 沒取得，伺服器DHCP領域設定錯誤，領域選項003路由器設定伺服器IP


