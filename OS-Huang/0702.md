# Windows Server 帳戶與 NTFS 權限設定筆記

**講者**: pro.Huang
**日期**: 2025-7-2
**主題**: 使用者 NTFS 權限管理

---

## 新增使用者與群組
1. 伺服器管理員 > 工具 > 電腦管理 > 系統工具 > 本機使用者和群組
2. 使用者 > 右鍵 > 新增使用者 > ID、password、取消下次登入變更密碼
3. 群組 > 建立群組 > 新增使用者(成員1;成員2;) > 建立

### 密碼複雜度設定
1. 伺服器管理員 > 工具 > 本機安全性原則 > 帳戶原則 > 密碼原則
2. 複雜性需求、最小長度、使用期限、最短期限、密碼歷程等設定

## 變更資料夾權限
1. 右鍵資料夾 > 內容 > 安全性 > 進階
2. 停用繼承(若要移除部分權限) > 轉換繼承(保有目前所有規則但不繼承) > 變更套用子資料夾(強制套用且繼承父權限)  > 確定
3. 更換使用者測試
4. 新增`修改`必定新增`寫入`

### 實務案例
* 通常以`群組`為單位來管理，單獨增減`使用者`權限會複雜化流程。
* 通常會移除`使用者特殊權限`，`使用者`只能在`公共共享區`建立其資料夾。

## 網路共用資料夾
* **一般共用設定會覆寫原有使用者設定**
* **進階共用會與Windows NTFS做權限累加取最嚴謹**
    * 當`user1`有本地端`完全控制`但是共用權限everyone限制`讀取`，遠端連線近來伺服器僅會有`讀取`功能。
    * 所以共用進階設定要設定`完全控制`才能完全套用原有設定。
    
### 關閉網路機器探索
搜尋`服務` > fFunction Discovery Provider Hostun > 狀態[改成停止]、手動改停止後便無法在網路服務找到這台機器。

### 網路磁碟機
* 使用者電腦 > 右鍵 本機 > 新增網路磁碟機 > 
    * 選擇`編號`
    * 資料夾`\\IP\path\` or `\\hostname\path\`
    * 認證可以自動登入
    * 使用不同的登入 = 將本機帳戶傳送給server?
 
 ### 遠端使用者設定
 * **伺服器使用者沒有設置密碼就無法遠端連線**
 * **必須設定目標資料夾完整名稱**
    * \\\\ `HostNameOrIP`\\`FolderName` 

#### 失敗區
1. 授權給特定人員是寫入NTFS本地，everyone可以免登入存取，風險更高
2. 共用資料的everyone 與 NTFS 的everyone 權限 差異大
    * NTFS第一層給everyone，連群組規則都可以疊加。
    * 共用權限everyone會比較NTFS，取最嚴謹。共用權限完全存取xNTFS讀取。結果是僅讀取
    * 檢查群組安全性原則
        * `不要有everyone`
        * `不要有everyone`
        * `不要有everyone`
3. 找不到使用者
    * 移除`users`所有權限
    * 帳戶過期
    * 帳戶不屬於`Users`

### 規模化部署
AD 伺服器分享控制權限
DC網域主控站 網域群組原則

## 拓樸
- DC (網域主控站) 
    - FS (資料伺服器)
    - PCs(使用者)

* DC 控制人員
    * NTFS 分享
    * `網域使用者群組` : 最常用功能
    * 需求
        1. 固定IP
        2. 網域名稱

### 虛擬環境下新增AD DS/LDS
1. 不要直接使用clone原本的FS伺服器(MAC衝突、IP衝突)
2. 找到`Sysprep` path:`C:Windows\system32\Sysprep\sysprep.exe`
    * 一般化 :重製所有設定 ip, hostname
    * 結束後 : 重新啟動，大量部署可選關機
3. 重新開機後 建立管理員密碼
4. 更改固定IP、Hostname、允許網路上的探索 > 重啟套用設定
5. 伺服器儀錶板>新增角色>Active Directory 網域服務> 安裝AD DS/AD LDS功能 >等待安裝
6. 伺服器管理員>儀表板>等待工作>將此伺服器升級成網域控制站>
    * 新增樹系(第三個)
    * 根網域名稱 Lab03.com.tw
    * 等待安裝
    * 建立 目錄服務還原模式密碼
7. DNS 選項 (找不到父系網域) : 直接下一步
8. NETBIOS 名稱 > 不更改 
9. 路徑 > 不更改
10. 先決條件檢查 > 等待
11. 安裝或移除網域控制服務 > 自動重啟電腦
12. 使用者變成 Lab03/administrator 登入 ; 網域/使用者ID
    * 本機電腦使用者與群組規則轉移
    * IP的DNS 自動轉成 127.0.0.1(本機網路)，在虛擬機內改成匝道路由可上網
    

 


#### AD
密碼複雜性修改
不是用本機安全性原則





# ChatGPT 管理Server 檢查順序
新Server與舊機器的檢查順序有所差異分開討論

## New Server
1. 硬體資源: CPU、RAM、Storages
2. 軟體版本: 主機名稱、固定IP、DNS
3. 服務項目: AD、DHCP、DNS
4. 安全性: 防火牆、管理員權限
5. 網路狀態: 網路
6. 監測與備份: 監控資源與錯誤處理

## Old Server
1. 檢查軟硬體版本、
2. 角色( AD, DHCP, DNS, 檔案伺服器)
3. 更新與使用率: 負載、警告
3. 運作:網路、連線
4. 安全性
5. 監控與備份









