# IPv4 VLSM and IPv6
- speacher: pro. Chen
- date 2025-7-11
- class 7
- CCNA1 chapter 11-12.5

#subnet
#網段
#802.1X
#domain
#網域
#IPv6
#exam
#GUA
#LLA
#SLAAC

## 1. RFC 3330

**Summary of "Still Working Now" vs. "Abandoned/Changed":**

**Rules Still Working Now (Fundamental & Actively Used):**

* **0.0.0.0/8**: Still critical for specific uses (default route, unconfigured host).
* **10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16**: Private-Use Networks (RFC 1918).
* **127.0.0.0/8**: Loopback.
* **169.254.0.0/16**: Link Local (APIPA).
* **192.0.2.0/24**: Test-Net (TEST-NET-1).
* **198.18.0.0/15**: Network Interconnect Device Benchmark Testing.
* **224.0.0.0/4**: Multicast.
* **240.0.0.0/4**: Reserved for Future Use (Class E).

**Rules Abandoned or Significantly Changed (Original Specificity No Longer Applies):**

* **14.0.0.0/8**: No longer specifically "Public-Data Networks"; now general public addresses.
* **24.0.0.0/8**: No longer specifically "Cable Television Networks"; now general public addresses.
* **39.0.0.0/8**: No longer generally "Reserved but subject to allocation"; now general public addresses.
* **128.0.0.0/16**: No longer specifically "Reserved but subject to allocation"; parts have been allocated.
* **191.255.0.0/16**: No longer specifically "Reserved but subject to allocation"; parts have been allocated.
* **192.0.0.0/24**: While still special, it's no longer just "Reserved but subject to allocation" in a generic sense; it has specific IANA assignments.
* **192.88.99.0/24**: 6to4 Relay Anycast is largely deprecated.
* **223.255.255.0/24**: No longer specifically "Reserved but subject to allocation"; has been allocated.

The main takeaway is that the general "reserved but subject to allocation" entries from older RFCs have mostly been allocated to various Regional Internet Registries (RIRs) for public assignment due to IPv4 address exhaustion. The more specific, special-purpose blocks tend to retain their original function.

### 802.1X
網路路由認證

## 2. 結構化設計

- 子網路分配，在台灣實務上所需的子網路大小為 **主機數量 + 3** (網域、廣播、gateway)
    1. 各區域需要主機數量，至少N+3 個IP大小網域
    2. 計算符合的網域大小後排列 29 hosts=IP/27、12 hosts => IP/28
    3. 取最大網段 256/8 = 32， 
    4. 
- IP分配: 網域最後1個給路由最後10個給網路設備或伺服器使用，能有效避免DHCP衝突與非資訊人員的錯誤設定
- 切割 /28 或更小的子網路是為了實現 IPv4 位址的最佳化利用和網路的極致隔離。這些小型子網路在點對點連線、小型獨立系統以及需要高度安全隔離的特殊場景中發揮著關鍵作用。它們是精細化網路設計的重要體現。

|mask|/number|
|:-|:-|
|255.255.255.0|24|
|255.255.255.128|25|
|255.255.255.`192`|`26`| 
|255.255.255.`224`|`27`|
|255.255.255.`240`|`28`|
|255.255.255.248|29|
|255.255.255.252|30|

由大切小，符合網路聚合性

#### c11 exam
|question|answer|
|:-|:-|
|Which statement is true about **variable-length subnet** masking?|depeding on required.|
|Why does a Layer 3 device perform the ANDing process on a destination IP address and subnet mask?|identify destination network|
|||



### 固定IP 與 VLAN
---

這是一個很棒的概括性說法！你抓住了**固定 IP** 和 **VLAN** 在網路管理中的常見用途和設計理念。

---

### 固定 IP：管理硬體（設備）

你說的「固定 IP 管理硬體」是非常貼切的。在實務上，我們確實會給以下這些**「硬體設備」分配固定 IP 位址**：

* **伺服器 (Servers):** 無論是網頁伺服器、資料庫伺服器、檔案伺服器、郵件伺服器等，它們提供的服務需要穩定且不變的 IP 位址，方便用戶端和應用程式能持續找到它們。
* **網路基礎設施設備 (Network Infrastructure Devices):**
    * **路由器 (Routers):** 作為閘道，連接不同子網路或內部網路與外部網路。
    * **交換器 (Switches):** 尤其是管理型交換器，方便網管人員透過 IP 進行遠端管理。
    * **防火牆 (Firewalls):** 網路安全的第一道防線，其管理介面和服務通常需要固定 IP。
    * **無線基地台 (Wireless Access Points - APs):** 方便管理員定位和設定。
* **網路印表機 (Network Printers):** 讓使用者能夠穩定地連線和列印。
* **監控設備 (Surveillance Systems):** 例如 IP 攝影機、NVR (Network Video Recorder) 等。
* **其他特殊設備:** 如 NAS (Network Attached Storage)、VoIP 電話系統、門禁系統、考勤機等，它們通常都需要一個固定的 IP 才能正常運作或被管理。

**為什麼要給這些硬體固定 IP？**

* **可預測性:** 確保這些設備始終在同一個位址，方便其他設備或服務能穩定地找到它們。
* **可靠性:** 避免因 IP 位址變動而導致服務中斷。
* **管理便利性:** 網管人員可以輕鬆地遠端登入這些設備進行配置、監控和故障排除。
* **DNS 記錄:** 方便為這些固定 IP 的服務建立 DNS 記錄，讓使用者可以用網域名稱來存取服務。

---

### VLAN：管理人員（或群組）

你說的「VLAN 管理人員」也說得很到位，因為 VLAN 的主要目的是基於**邏輯分組**來隔離廣播域和限制通訊，而這些邏輯分組往往是依據**人員的部門、職責或身份**來劃分的。

以下是一些常見的 VLAN 應用情境，它們都與「管理人員」或「群組」的概念息息相關：

* **部門隔離:**
    * **VLAN 10 (銷售部):** 專供銷售人員使用，限制與其他部門的直接通訊。
    * **VLAN 20 (研發部):** 供研發人員使用，可能對外網有特殊存取策略，對內則可存取特定的開發伺服器。
    * **VLAN 30 (人資部/財務部):** 存放敏感資料的部門，需要嚴格的隔離和安全控制。
* **使用者類型隔離:**
    * **VLAN 40 (員工):** 供所有內部員工日常工作使用。
    * **VLAN 50 (訪客):** 專供外部訪客使用，通常會有嚴格的網路存取限制（例如只能上網，不能存取內部資源），且與內部網路完全隔離。
    * **VLAN 60 (管理員):** 專供網管人員用來管理網路設備的獨立 VLAN，通常有最高的安全級別。
* **設備類型隔離（廣義上的「人員」使用設備）:**
    * **VLAN 70 (語音/VoIP):** 專門用於 IP 電話的流量，可以設定 QoS 優先級以確保通話品質。
    * **VLAN 80 (無線網路):** 隔離無線網路用戶的流量，通常會再細分成員工 Wi-Fi 和訪客 Wi-Fi 對應不同的 VLAN。

**為什麼 VLAN 適合管理人員/群組？**

* **安全性:** 限制了廣播域，防止不同部門之間的未經授權的直接通訊，並能針對特定部門設定不同的安全策略。
* **效能:** 減少了廣播流量對整體網路的影響，提升特定部門網路的效能。
* **管理彈性:** 即使員工從一個辦公室移動到另一個辦公室，只要其連線的交換器埠被配置到正確的 VLAN，其 IP 位址和網路存取權限就能保持不變。
* **QoS (服務品質):** 可以針對不同 VLAN 的流量設定不同的優先級，確保關鍵業務應用（例如 VoIP 或視訊會議）的順暢運行。

---

### 總結

你的觀察非常精闢！這兩者在網路管理中扮演的角色正是：

* **固定 IP 讓我們能夠精確地定位和管理網路中的「靜態硬體資源」。**
* **VLAN 讓我們能夠靈活地基於「人員、部門或功能」對網路進行邏輯隔離和策略控制。**

它們是現代網路不可或缺的基石，共同構建出一個既高效、又安全、且易於管理的網路環境。


# IPv6

理論上v6更好，但實務上走並行
長度128位元

書寫時，前導0可以省略，`092f` => `92f`

可以省略整段0000 ， 最多使用一次 ， `80ff::128a`， 若有多段0000，僅可以縮排一次，確保唯一可判讀性。

|名稱|說明|
|:-|:-|
|GUA全域單播| 對外真實IP|
|link-local| 區域IP找不到DHCP時使用|
---

|範圍           |說明|
|:------------  |:-|
|迴環 ::1/128           |對自己服務|
|私有 fc00::/7-fdff::/7 | 目前不用|
|嵌入式IPv4             |兼容IPv4裝置使用|



目前使用到的IPv6，001::/3 分發 `2000::` - `3fff::`
- 公司網路IP/48 
- 子網路/49-64，16bits
- 主機/65-128
- 啟用IPv6，同時啟用LLA，可用來連線區域網路，且無法跨路由器
- fe80::aaaa:2b:cdef%19 ， %19 為實體介面卡編號


發放IPv6
- SLAAC 無狀態
- DHCP 有狀態IPV6


cisco ipv6 setting
`ipv6 address fe80::1:1 link-local`
practice12.4.4

#practice12.4.5
```
Class-B(config)#line console 0
Class-B(config-line)#password cisco
Class-B(config-line)#login
Class-B(config-line)#line vty 0 15
Class-B(config-line)#password cisco
Class-B(config-line)#login
```



## dynamic IPv6

The ICMPv6 RA message includes the following:
- **Network prefix and prefix length** - This tells the device which network it belongs to.
- **Default gateway address** - This is an IPv6 **LLA(fe80)**, the source IPv6 address of the RA message.
- **DNS addresses and domain name** - These are the addresses of DNS servers and a domain name.

There are three methods for RA messages:
- **Method 1: SLAAC** - “I have everything you need including the prefix, prefix length, and default gateway address.” 
- **Method 2: SLAAC with a stateless DHCPv6 server** - “Here is my information but you need to get other information such as DNS addresses from a stateless DHCPv6 server.”
- **Method 3: Stateful DHCPv6 (no SLAAC)** - “I can give you your default gateway address. You need to ask a stateful DHCPv6 server for all your other information.”


補充
- method 1: Created by client device/64 ,RA && EUI-64 or random 64-bit number

### EUI-64
An EUI-64 Interface ID is represented in binary and is made up of three parts:

- 24-bit OUI from the client MAC address, but the `7th bit` (the Universally/Locally (U/L) bit) is reversed. This means that if the 7th bit is a 0, it becomes a 1, and vice versa.
- The inserted 16-bit value `fffe` (in hexadecimal).
- 24-bit Device Identifier from the client `MAC address`.






