# 維護與監控
- speacher: pro. Chen
- date: 2025-7-30
- class 10
- chapter 1 
- chapter 2 
- chapter 3 多台交換器
#switch #interfaceOption #實務 #市場 #Vlan #802.1Q #還原預設
#vlan.dat #practic_VlanSetting

## 實務
職務上都是維護既有系統，所以檢查能力為必備

1. 介面卡問題
    - status up, 有電
    - protocol, 協定(速度)
    - 通常 status up and protocol down 的錯誤，兩邊都使用定速傳輸(1G/100M)，傳輸功率不同錯誤
>show ip interface brief 

2. IP設定
    - mask對IPv4很重要，(廣播位置)

3. PING
    - windows系統 預設關閉
    - arp 查看同個網域的設備
4. show option
- section
>show ip interface brief | section vty
- include
包含，但不準確，up難用
>show ip interface brief | inlcude up
>show interface| include Description|connected
- exclude 
排除，未使用，較常用
>show ip interface brief | exclude unassigned
- begin
從哪裡開始
>show ip route | begin Gateway

#practice1.5.7

5. show history
    - cisco only history 10 orders
    - 華為借鏡cisco設備
    - terminal history size 200
    檢測 廠商操作，常留後門(救援用)，需要記憶體
#practice1.5.9
`pipe-line`, split cmds with ` | `, must place spaces.
`or logic`, split keywords within `|` , both important


6. 市場 
70%的市面上路由器為Cisco系統。

7. 最後選擇路由
>S* 0.0.0.0/0 [1/0] 2090.165.200.224


預設通道，找不到其他介面，就送過去

### packet tracer
1.6.1
中文題目誤植
console 與  vty 連線密碼應為 `Ciscolinepa55`


## 2 交換器
MAC 找不到IP，廣播所有Port除了來源port

1. 碰撞領域
由router與 switch 分割

### 實務
交換機port密度
96port / 48port\*2 / 24-port\*4
效能96>48>24
效能瓶頸，越靠近route放越高級，1G串聯越後面越慢

預設vlan1
跨switch傳輸vlan標籤, 802.1Q
每個port指寧容許一個vlan

## 3 多台交換器 Vlan
1. 定義vlan中繼(Trunks)
2. 802.1Q協定，可使用FastEthernet, Gigabit Ethernet, 10-Gigabit Ethernet
3. VID，12-bit, 1-4095
4. 語音Vlan，設定QoS，安全性原則，CDP知道溝通協定



### 實務
1. 三台實體機 跑10G到交換器，擁有80台虛擬機
2. 動態平衡資源
3. 原生Vlan自己設定

登入管理是 line console|vty|aux

### Catalyst
Cisco思科設備 1-1006 常用
vlan 1 為預設，不能動
1002-1005,舊協定
vlan.dat 儲存設定
1006-4094 全球企業註冊

### 設定Vlan
vlan 20

>show vlan summary

預設vlan 有5個: 1, 1002, 1003, 1004, 1005

```console 
關閉Vlan
S1(config)# interface fa0/18
S1(config-if)# no switchport access vlan
```
port 未指定會提供 `vlan 1`
還原預設 S1(config)# delete vlan.dat

#practice3.3.11 vlan setting

```console
將介面設定為存取連接埠，並指派 VLAN，如 下所示：
     VLAN 10: FastEthernet 0/11
 
S2(config)# interface f0/11
S2(config-if)# switchport mode access
S2(config-if)# switchport access vlan 10
```
```console
S3 F0/11 介面必須設定為支援使用 VLAN 10 進入 PC4 的使用者 流量，以及使用 VLAN 150 進入 IP 電話的語音流量。 介面也必須啟用 QoS，並信任由 IP 電話 指派的服務類別 (CoS) 值。IP 語音流量需要保證最低 輸送量，才能支援可接受的語音通訊品質。此命令 可協助交換器提供此保證最低輸送量。

S3(config)# interface f0/11
S3(config-if)# mls qos trust cos
S3(config-if)# switchport voice vlan 150
```


# Gemini 1
您問到 IPv6 是否用 `fe80::` 來模擬 ARP 功能，這個說法不是完全精確，但與其背後的概念有關。

---

### IPv6 沒有 ARP，而是使用 **NDP (Neighbor Discovery Protocol)**

IPv6 並沒有直接使用像 IPv4 那樣的 ARP (Address Resolution Protocol)。在 IPv6 中，ARP 的功能以及其他一些 IPv4 的協議（如 ICMP 路由器發現和 ICMP 重定向）都被整合到了 **Neighbor Discovery Protocol (NDP)** 中。

---

### NDP 如何運作？

NDP 運作在 IPv6 的網際網路層，它使用多種 **ICMPv6 (Internet Control Message Protocol for IPv6)** 訊息來執行其功能，其中包括：

* **Neighbor Solicitation (NS) 鄰居請求訊息：** 當一個 IPv6 節點需要知道同一個鏈路上另一個節點的鏈路層地址 (MAC 位址) 時，它會發送 NS 訊息。這個訊息有點像 IPv4 的 ARP 請求。
* **Neighbor Advertisement (NA) 鄰居通告訊息：** 收到 NS 訊息的節點會回覆 NA 訊息，其中包含自己的鏈路層地址。這就像 IPv4 的 ARP 回覆。
* **Router Solicitation (RS) 路由器請求訊息：** 主機用來尋找鏈路上的路由器。
* **Router Advertisement (RA) 路由器通告訊息：** 路由器用來通告其存在、前綴資訊、預設路由等。
* **Redirect 重新導向訊息：** 路由器用來告知主機有更好的下一跳路徑。

---

### `fe80::` (Link-Local Address) 在 NDP 中的角色

您提到的 `fe80::` 是 **IPv6 的鏈路本地地址 (Link-Local Address)**。每個啟用 IPv6 的介面都會自動配置一個鏈路本地地址，其格式通常是 `fe80::/64`。

**鏈路本地地址在 NDP 中扮演著非常重要的角色：**

1.  **NDP 訊息的來源和目的地址：** 在許多 NDP 訊息（例如 Neighbor Solicitation 和 Neighbor Advertisement）的 IPv6 封包頭中，來源和目的地址通常會使用鏈路本地地址。這表示這些訊息僅在本地鏈路（或稱為廣播域，但在 IPv6 中通常是多播域）內有效，不會被路由器轉發。
2.  **與 IPv4 ARP 的相似性：** 就像 ARP 只在本地廣播域內運作以解析 MAC 地址一樣，NDP 中的 Neighbor Solicitation 和 Neighbor Advertisement 訊息也只在本地鏈路範圍內運作，並利用鏈路本地地址來尋找同一鏈路上其他節點的 MAC 地址。
3.  ** solicited-node multicast address (多播節點請求地址)：** 為了提高效率，NDP 不像 ARP 那樣進行廣播。當一個節點需要解析另一個 IPv6 地址的 MAC 地址時，它會向該 IPv6 地址對應的 **solicited-node multicast address** 發送 Neighbor Solicitation 訊息。這個多播地址是由 `FF02::1:FFXX:XXXX` 構成的，其中 `XX:XXXX` 是目標 IPv6 地址的最後 24 位。只有擁有該目標 IPv6 地址的節點才會監聽並處理這個特定的多播組，從而避免了像 IPv4 ARP 廣播那樣對所有節點的干擾。這些多播通訊也通常使用鏈路本地地址作為來源。

---

### 結論

因此，不能說 `fe80::` 是用來「模擬」ARP 功能。更準確的說法是：

* **IPv6 使用 NDP (Neighbor Discovery Protocol) 來取代 ARP 的功能。**
* **`fe80::` 鏈路本地地址在 NDP 的運作中是不可或缺的，它作為許多 NDP 訊息的來源和目的地址，確保這些本地鏈路的操作能夠正常進行，並輔助了地址解析的過程。**

NDP 比 ARP 更為強大和高效，它提供了許多額外的功能，例如無狀態地址自動配置 (SLAAC) 和重複地址檢測 (DAD) 等。


# Gemini 2
You've correctly identified a key feature of the Cisco IOS command line interface (CLI): the use of the pipe character (`|`) to filter the output of `show` commands. This is an extremely powerful and time-saving tool for network administrators.

Let's break down the two patterns you've mentioned and add some more details.

### Pattern 1: `cmd1 | cmd2`

This is the most common use of the pipe. You execute a `show` command (`cmd1`), and then you "pipe" the output of that command to a filtering function (`cmd2`). The most common filtering functions are:

* **`include`**: This is like a "grep" command. It shows you only the lines that contain a specific string.
* **`exclude`**: This is the opposite of `include`. It shows you all lines *except* those that contain a specific string.
* **`begin`**: This command starts the output from the first line that matches a specific string and shows all the output from that point on.
* **`section`**: This is a more advanced `begin` that intelligently finds the beginning and end of a section (e.g., a specific configuration block) and displays only that section. This is very useful with `show running-config`.

**Examples:**

* `show running-config | include hostname`
    * This will only show the line with the hostname of the device.
* `show ip interface brief | exclude unassigned`
    * This will show all interfaces that have an IP address assigned, excluding the ones with "unassigned" in the output.
* `show running-config | begin interface GigabitEthernet0/1`
    * This will display the running configuration starting from the `interface GigabitEthernet0/1` line, including all the configurations for that interface and all subsequent configurations.
* `show running-config | section router bgp`
    * This will show only the BGP configuration block, from the `router bgp` line until the next major configuration block.

### Pattern 2: `cmd1 | cmd2.1 | cmd2.2`

You've observed a more complex pattern, which is also very powerful. While the pipe character is primarily a one-to-one function (`show command` -> `filter`), you can achieve an "OR" logical operation by combining keywords and regular expressions. The second pipe character `|` in this context doesn't start a new filter function, but rather acts as a regular expression "OR".

This is often used with the `include` and `exclude` filters.

**Example:**

Let's say you want to see all interfaces that are either "down" or "administratively down".

* `show ip interface brief | include down`
    * This would show both "down" and "administratively down" interfaces because the string "down" is in both outputs.

But what if you wanted to include two very different words or patterns?

* `show interfaces | include protocol|input rate`
    * This command is using regular expression syntax. The `|` here is part of the regular expression, not a separate pipe function.
    * The `include` keyword is looking for lines that contain either the string "protocol" OR the string "input rate".
    * This would show lines like "GigabitEthernet0/1 is up, line protocol is up" and "5 minute input rate 0 bits/sec...".

You'll notice that there's no space before or after the second pipe (`|`) character. This is a common indicator that it's being used as a regular expression "OR" and not as a separate filtering function.

### A note on Regular Expressions (Regex)

The filtering functions `include`, `exclude`, and `begin` all support regular expressions. This gives you a great deal of flexibility. Here are a few common regex characters you might see:

* `^`: Matches the beginning of a line. (e.g., `^interface` would only match lines that start with "interface").
* `$`: Matches the end of a line.
* `.`: Matches any single character.
* `*`: Matches zero or more instances of the preceding character.
* `[]`: Matches any single character within the brackets. (e.g., `[0-9]` matches any single digit).
* `|`: The "OR" operator. (e.g., `(Ethernet|Gigabit)` matches either "Ethernet" or "Gigabit").

### Summary

The patterns you've observed are correct. The key is to understand the context of the `|` character.

* `show command | filter_keyword [string]`
    * The pipe is used to send the output of the `show` command to a single filtering function.
* `show command | filter_keyword [string1|string2]`
    * The pipe is used *within the regular expression* of the filter function to represent a logical "OR" condition.










